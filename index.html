<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú¯Ø§Ù„Ø±ÛŒ Ø·Ù„Ø§ Ø´Ø±ÙˆÛŒÙ† - Ù‚ÛŒÙ…Øª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', Tahoma, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }
        
        .container {
            max-width: 450px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo-container {
            margin-bottom: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        
        .brand-logo {
            width: 280px;
            height: auto;
            margin-bottom: -30px;
            display: flex;
            justify-content: center;
        }
        
        .brand-logo img {
            width: 200%;
            height: auto;
            max-width: 100%;
            border: none;
            background: transparent;
            box-shadow: none;
            border-radius: 0;
        }
        
        .logo-text {
            text-align: center;
            width: 100%;
        }
        
        .logo h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #85d0cb;
            font-weight: 700;
            letter-spacing: -0.5px;
            line-height: 1.3;
        }
        
        .logo p {
            font-size: 1rem;
            opacity: 0.8;
            font-weight: 400;
            line-height: 0.5;
        }
        
        .links {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: -25px;
            width: 100%;
            max-width: 340px;
        }
        
        .link-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            background: rgba(133, 208, 203, 0.15);
            color: #fff;
            text-decoration: none;
            padding: 18px 25px;
            border-radius: 14px;
            font-weight: 500;
            font-size: 1.05rem;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(133, 208, 203, 0.2);
            position: relative;
            overflow: hidden;
            width: 100%;
        }
        
        .link-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(133, 208, 203, 0.15);
            border: 1px solid rgba(133, 208, 203, 0.3);
            background: rgba(133, 208, 203, 0.25);
        }
        
        .link-button i {
            font-size: 1.3rem;
            color: #85d0cb;
            min-width: 24px; /* Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ø² Ø¨Ù‡ØªØ± */
            text-align: center; /* Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ø² Ø¨Ù‡ØªØ± */
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø®Ø´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ */
        .price-section {
            width: 100%;
            max-width: 340px;
            margin: 10px 0;
        }
        
        .price-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            background: rgba(133, 208, 203, 0.15);
            color: #fff;
            text-decoration: none;
            padding: 18px 25px;
            border-radius: 14px;
            font-weight: 500;
            font-size: 1.05rem;
            transition: all 0.4s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(133, 208, 203, 0.2);
            position: relative;
            overflow: hidden;
            width: 100%;
            cursor: pointer;
        }
        
        .price-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(133, 208, 203, 0.15);
            border: 1px solid rgba(133, 208, 203, 0.3);
            background: rgba(133, 208, 203, 0.25);
        }
        
        .price-button i {
            font-size: 1.3rem;
            color: #85d0cb;
            min-width: 24px; /* Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ø² Ø¨Ù‡ØªØ± */
            text-align: center; /* Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ø² Ø¨Ù‡ØªØ± */
        }
        
        /* Ù¾Ù†Ù„ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ */
        .price-panel {
            background: rgba(133, 208, 203, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(133, 208, 203, 0.2);
            border-radius: 16px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }
        
        .price-panel.active {
            display: block;
        }
        
        .price-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #85d0cb;
        }
        
        .price-header i {
            font-size: 1.4rem;
        }
        
        .price-header h3 {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .price-category {
            margin-bottom: 25px;
        }
        
        .category-title {
            color: #85d0cb;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(133, 208, 203, 0.3);
        }
        
        .price-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .price-label {
            font-weight: 500;
            color: #e0e0e0;
            font-size: 0.9rem;
        }
        
        .price-value {
            font-weight: 600;
            direction: ltr;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .price-arrow {
            font-size: 0.9rem;
        }
        
        .up {
            color: #4caf50;
        }
        
        .down {
            color: #f44336;
        }
        
        .neutral {
            color: #b0b0b0;
        }
        
        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #f44336;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        .offline-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #b0b0b0;
            margin-right: 8px;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; }
            100% { opacity: 1; }
        }
        
        .price-time {
            text-align: center;
            margin-top: 20px;
            font-size: 0.8rem;
            opacity: 0.7;
            color: #85d0cb;
        }
        
        .time-status {
            text-align: center;
            margin-top: 5px;
            font-size: 0.7rem;
            opacity: 0.7;
            color: #85d0cb;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #85d0cb;
        }
        
        .error {
            text-align: center;
            padding: 20px;
            color: #f44336;
            background: rgba(244, 67, 54, 0.1);
            border-radius: 10px;
            margin: 10px 0;
        }
        
        .offline-notice {
            text-align: center;
            padding: 10px;
            color: #ff9800;
            background: rgba(255, 152, 0, 0.1);
            border-radius: 8px;
            margin: 10px 0;
            font-size: 0.8rem;
        }
        
        .footer {
            margin-top: 40px;
            font-size: 0.8rem;
            opacity: 0.6;
            font-weight: 300;
            text-align: center;
            width: 100%;
        }
        
        .bg-glow {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(133, 208, 203, 0.1) 0%, rgba(133, 208, 203, 0) 70%);
            z-index: -1;
            pointer-events: none;
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }
            
            .brand-logo {
                width: 320px; /* Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø§ÛŒØ² Ù„ÙˆÚ¯Ùˆ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
                margin-bottom: -60px; /* ØªÙ†Ø¸ÛŒÙ… Ù…Ø¬Ø¯Ø¯ ÙØ§ØµÙ„Ù‡ */
            }
            
            .brand-logo img {
                width: 180%; /* Ú©Ø§Ù‡Ø´ Ø¹Ø±Ø¶ ØªØµÙˆÛŒØ± Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ØªØ± */
            }
            
            .price-panel {
                padding: 15px;
            }
            
            .price-item {
                padding: 10px 12px;
            }
            
            .link-button, .price-button {
                padding: 16px 20px;
                gap: 10px; /* Ú©Ø§Ù‡Ø´ ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† Ø¢ÛŒÚ©ÙˆÙ† Ùˆ Ù…ØªÙ† Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ØªØ± */
            }
            
            .link-button i, .price-button i {
                font-size: 1.2rem; /* ØªÙ†Ø¸ÛŒÙ… Ø³Ø§ÛŒØ² Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ */
                min-width: 22px; /* ØªÙ†Ø¸ÛŒÙ… Ø¹Ø±Ø¶ Ø­Ø¯Ø§Ù‚Ù„ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ±Ø§Ø² Ø¨Ù‡ØªØ± */
            }
            
            .price-label, .price-value {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 360px) {
            .brand-logo {
                width: 280px; /* ØªÙ†Ø¸ÛŒÙ… Ø³Ø§ÛŒØ² Ø¨Ø±Ø§ÛŒ ØµÙØ­Ù‡â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú©â€ŒØªØ± */
            }
            
            .brand-logo img {
                width: 160%; /* ØªÙ†Ø¸ÛŒÙ… Ø¹Ø±Ø¶ ØªØµÙˆÛŒØ± Ø¨Ø±Ø§ÛŒ ØµÙØ­Ù‡â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú©â€ŒØªØ± */
            }
            
            .link-button, .price-button {
                padding: 14px 16px;
                font-size: 1rem; /* Ú©Ø§Ù‡Ø´ Ø³Ø§ÛŒØ² ÙÙˆÙ†Øª Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ØªØ± */
            }
            
            .link-button i, .price-button i {
                font-size: 1.1rem; /* Ú©Ø§Ù‡Ø´ Ø³Ø§ÛŒØ² Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ */
                min-width: 20px; /* Ú©Ø§Ù‡Ø´ Ø¹Ø±Ø¶ Ø­Ø¯Ø§Ù‚Ù„ÛŒ */
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="bg-glow"></div>
    
    <div class="container">
        <div class="logo-container">
            <div class="brand-logo">
                <img src="https://s6.uupload.ir/files/hia_copy_zd8w.png" alt="Ú¯Ø§Ù„Ø±ÛŒ Ø·Ù„Ø§ Ø´Ø±ÙˆÛŒÙ†">
            </div>
            <div class="logo">
                <div class="logo-text">
                    <h1>Ú¯Ø§Ù„Ø±ÛŒ Ø·Ù„Ø§ Ø´Ø±ÙˆÛŒÙ†</h1>
                    <p>Ù‚ÛŒÙ…Øª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡</p>
                </div>
            </div>
        </div>
        
        <div class="links">
            <!-- Ø¯Ú©Ù…Ù‡ Ù‚ÛŒÙ…Øª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ -->
            <div class="price-section">
                <div class="price-button" onclick="togglePricePanel()">
                    <i class="fas fa-chart-line"></i>
                    Ù‚ÛŒÙ…Øª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ
                    <span id="priceIndicator" class="live-indicator"></span>
                </div>
                
                <div class="price-panel" id="pricePanel">
                    <div class="price-header">
                        <i class="fas fa-coins"></i>
                        <h3>Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</h3>
                    </div>
                    
                    <div id="priceContainer">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§...</p>
                        </div>
                    </div>
                    
                    <div class="price-time">
                        <span id="updateTime">Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: -</span>
                    </div>
                    <div class="time-status">
                        <span id="timeStatus">ÙˆØ¶Ø¹ÛŒØª: Ø¨Ø±Ø±Ø³ÛŒ Ø²Ù…Ø§Ù†...</span>
                    </div>
                </div>
            </div>
            
            <!-- Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± -->
            <a href="https://maps.app.goo.gl/yXq4s3RH57QH6VCB9" class="link-button" target="_blank">
                <i class="fas fa-map-marker-alt"></i>
                Ø¢Ø¯Ø±Ø³ Ú¯ÙˆÚ¯Ù„ Ù…Ù¾
            </a>
            
            <a href="https://t.me/shervingold" class="link-button" target="_blank">
                <i class="fab fa-telegram"></i>
                Ú©Ø§Ù†Ø§Ù„ ØªÙ„Ú¯Ø±Ø§Ù…
            </a>
            
            <a href="https://wa.me/989367499217" class="link-button" target="_blank">
                <i class="fab fa-whatsapp"></i>
                ÙˆØ§ØªØ³Ø§Ù¾
            </a>
        </div>
        
        <div class="footer">
            <p>Â© 2025 Ú¯Ø§Ù„Ø±ÛŒ Ø·Ù„Ø§ Ø´Ø±ÙˆÛŒÙ†. ØªÙ…Ø§Ù…ÛŒ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª.</p>
        </div>
    </div>

    <script>
        const API_URL = "https://BrsApi.ir/Api/Market/Gold_Currency.php?key=FreeE4uMPdiKOdaCSkCF5AsR7Qw1kh4w";
        let currentPrices = {};
        let pricePanelVisible = false;
        let apiCallCount = 0;
        let lastApiCallDate = null;
        let lastUpdateTime = null;
        let isActiveTime = false;
        let cachedPrices = null;

        // Ø¯Ø±ÛŒØ§ÙØª Ø²Ù…Ø§Ù† ØªÙ‡Ø±Ø§Ù†
        function getTehranTime() {
            const now = new Date();
            // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø²Ù…Ø§Ù† Ù…Ø­Ù„ÛŒ (ÙØ±Ø¶ Ø¨Ø± Ø§ÛŒÙ†Ú©Ù‡ Ø³Ø±ÙˆØ± Ø¯Ø± Ø§ÛŒØ±Ø§Ù† Ù‡Ø³Øª)
            return now;
        }

        // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¢ÛŒØ§ Ø¯Ø± Ø¨Ø§Ø²Ù‡ ÙØ¹Ø§Ù„ Ù‡Ø³ØªÛŒÙ… ÛŒØ§ Ù†Ù‡
        function checkActiveTime() {
            const tehranTime = getTehranTime();
            const hour = tehranTime.getHours();
            const minute = tehranTime.getMinutes();
            const currentTime = hour + minute / 60;
            
            // Ø¨Ø§Ø²Ù‡ ÙØ¹Ø§Ù„: 11:00 ØªØ§ 20:00 (11 ØµØ¨Ø­ ØªØ§ 8 Ø´Ø¨)
            isActiveTime = (currentTime >= 11 && currentTime < 20);
            
            // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ù†Ù…Ø§ÛŒØ´
            updateTimeStatus();
            
            return isActiveTime;
        }

        // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ø²Ù…Ø§Ù†
        function updateTimeStatus() {
            const statusElement = document.getElementById('timeStatus');
            const indicator = document.getElementById('priceIndicator');
            
            if (statusElement) {
                const tehranTime = getTehranTime();
                const timeString = tehranTime.toLocaleTimeString('fa-IR');
                const hour = tehranTime.getHours();
                
                if (isActiveTime) {
                    statusElement.innerHTML = `ğŸŸ¢ ÙˆØ¶Ø¹ÛŒØª: Ø¢Ù†Ù„Ø§ÛŒÙ† (Ø³Ø§Ø¹Øª ØªÙ‡Ø±Ø§Ù†: ${timeString})`;
                    indicator.className = 'live-indicator';
                } else {
                    if (hour < 11) {
                        statusElement.innerHTML = `âš« ÙˆØ¶Ø¹ÛŒØª: Ø¢ÙÙ„Ø§ÛŒÙ† - Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ù…Ø±ÙˆØ² Ø³Ø§Ø¹Øª Û±Û±:Û°Û°`;
                    } else {
                        statusElement.innerHTML = `âš« ÙˆØ¶Ø¹ÛŒØª: Ø¢ÙÙ„Ø§ÛŒÙ† - Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙØ±Ø¯Ø§ Ø³Ø§Ø¹Øª Û±Û±:Û°Û°`;
                    }
                    indicator.className = 'offline-indicator';
                }
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
        function loadCachedPrices() {
            const cached = localStorage.getItem('cachedGoldPrices');
            if (cached) {
                const data = JSON.parse(cached);
                const cacheTime = new Date(data.timestamp);
                const now = new Date();
                const hoursDiff = (now - cacheTime) / (1000 * 60 * 60);
                
                // Ø§Ú¯Ø± Ú©Ù…ØªØ± Ø§Ø² 24 Ø³Ø§Ø¹Øª Ú¯Ø°Ø´ØªÙ‡ØŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
                if (hoursDiff < 24) {
                    cachedPrices = data;
                    return true;
                }
            }
            return false;
        }

        // Ø°Ø®ÛŒØ±Ù‡ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§
        function savePricesToCache(prices) {
            const cacheData = {
                prices: prices,
                timestamp: new Date().getTime()
            };
            localStorage.setItem('cachedGoldPrices', JSON.stringify(cacheData));
            cachedPrices = cacheData;
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ API
        function initializeApiCounter() {
            const today = new Date().toDateString();
            const stored = localStorage.getItem('apiUsage');
            
            if (stored) {
                const data = JSON.parse(stored);
                if (data.date === today) {
                    apiCallCount = data.count;
                }
            }
            
            lastApiCallDate = today;
        }

        function incrementApiCounter() {
            const today = new Date().toDateString();
            
            if (lastApiCallDate !== today) {
                apiCallCount = 0;
                lastApiCallDate = today;
            }
            
            apiCallCount++;
            localStorage.setItem('apiUsage', JSON.stringify({
                date: today,
                count: apiCallCount
            }));
        }

        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
        function formatPrice(price) {
            if (!price) return '0';
            const cleanPrice = String(price).replace(/,/g, '');
            return new Intl.NumberFormat('fa-IR').format(Math.round(cleanPrice));
        }

        function getArrowFromChange(changePercent) {
            if (!changePercent) return { symbol: 'â—', class: 'neutral' };
            if (changePercent > 0) return { symbol: 'â–²', class: 'up' };
            if (changePercent < 0) return { symbol: 'â–¼', class: 'down' };
            return { symbol: 'â—', class: 'neutral' };
        }

        // Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù¾Ù†Ù„ Ù‚ÛŒÙ…Øª
        function togglePricePanel() {
            const panel = document.getElementById('pricePanel');
            pricePanelVisible = !pricePanelVisible;
            
            if (pricePanelVisible) {
                panel.classList.add('active');
                loadPrices();
            } else {
                panel.classList.remove('active');
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ Ø§Ø² API
        async function fetchGoldPrices() {
            try {
                const response = await fetch(API_URL);
                
                if (!response.ok) {
                    throw new Error(`Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Ø§ÙØ²Ø§ÛŒØ´ Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª
                incrementApiCounter();
                
                return data;
                
            } catch (error) {
                throw error;
            }
        }

        // ÙÛŒÙ„ØªØ± Ùˆ Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡ Ø¨Ø§ ØªØ±ØªÛŒØ¨ Ù…Ø´Ø®Øµ
        function displayGoldPrices(data, isCached = false) {
            if (!data || !data.gold) {
                throw new Error('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø·Ù„Ø§ ÛŒØ§ÙØª Ù†Ø´Ø¯');
            }

            const goldItems = data.gold;
            let html = '';

            if (isCached) {
                html += `
                    <div class="offline-notice">
                        <i class="fas fa-database"></i>
                        <p>Ù†Ù…Ø§ÛŒØ´ Ø¢Ø®Ø±ÛŒÙ† Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡</p>
                        <p style="margin-top: 5px; font-size: 0.7rem;">
                            Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø¹Ø¯ÛŒ: ÙØ±Ø¯Ø§ Ø³Ø§Ø¹Øª Û±Û±:Û°Û° ØµØ¨Ø­
                        </p>
                    </div>
                `;
            }

            // Ø¨Ø®Ø´ Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡
            html += `
                <div class="price-category">
                    <div class="category-title">Ø·Ù„Ø§ Ùˆ Ø³Ú©Ù‡</div>
                    <div class="price-grid">
            `;

            // ØªØ¹Ø±ÛŒÙ ØªØ±ØªÛŒØ¨ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±
            const desiredOrder = [
                'Ø§Ù†Ø³ Ø·Ù„Ø§',
                'Ø·Ù„Ø§ÛŒ 18 Ø¹ÛŒØ§Ø±',
                'Ø³Ú©Ù‡ Ø§Ù…Ø§Ù…ÛŒ',
                'Ø³Ú©Ù‡ Ø¨Ù‡Ø§Ø± Ø¢Ø²Ø§Ø¯ÛŒ',
                'Ù†ÛŒÙ… Ø³Ú©Ù‡',
                'Ø±Ø¨Ø¹ Ø³Ú©Ù‡',
                'Ø³Ú©Ù‡ ÛŒÚ© Ú¯Ø±Ù…ÛŒ'
            ];

            // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ±ØªÛŒØ¨ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±
            const sortedItems = [];
            
            desiredOrder.forEach(desiredName => {
                const foundItem = goldItems.find(item => {
                    const name = item.name || item.name_en || '';
                    return name.includes(desiredName);
                });
                
                if (foundItem) {
                    sortedItems.push(foundItem);
                }
            });

            // Ø§Ú¯Ø± Ø¢ÛŒØªÙ…ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯ØŒ Ù‡Ù…Ù‡ Ø±Ùˆ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø¯Ù‡
            const itemsToShow = sortedItems.length > 0 ? sortedItems : goldItems.slice(0, 7);

            itemsToShow.forEach(item => {
                const arrow = getArrowFromChange(item.change_percent);
                const price = item.price ? formatPrice(item.price) : '0';
                const unit = item.unit || '';
                let name = item.name || item.name_en || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                
                // Ø­Ø°Ù "(Ø¯Ù„Ø§Ø±)" Ø§Ø² Ù†Ø§Ù… Ø§Ù†Ø³ Ø·Ù„Ø§
                if (name.includes('Ø§Ù†Ø³ Ø·Ù„Ø§')) {
                    name = 'Ø§Ù†Ø³ Ø·Ù„Ø§';
                }
                
                html += `
                    <div class="price-item">
                        <span class="price-label">${name}</span>
                        <div class="price-value">
                            <span class="price-arrow ${arrow.class}">${arrow.symbol}</span>
                            ${price} ${unit}
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            return html;
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§
        function displayPrices(data, isCached = false) {
            const container = document.getElementById('priceContainer');
            const now = getTehranTime();
            
            if (!isCached) {
                lastUpdateTime = now;
                // Ø°Ø®ÛŒØ±Ù‡ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
                savePricesToCache(data);
            }
            
            try {
                const html = displayGoldPrices(data, isCached);
                container.innerHTML = html;
                
                const timeText = isCached ? 
                    `Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: ${lastUpdateTime ? lastUpdateTime.toLocaleTimeString('fa-IR') : 'Ù†Ø¯Ø§Ø±Ø¯'}` :
                    `Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: ${now.toLocaleTimeString('fa-IR')}`;
                
                document.getElementById('updateTime').textContent = timeText;
                    
            } catch (error) {
                container.innerHTML = `
                    <div class="error">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§
        async function loadPrices() {
            const container = document.getElementById('priceContainer');
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­Ø¯ÙˆØ¯ÛŒØª API
            if (apiCallCount >= 1500) {
                container.innerHTML = `
                    <div class="error">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª</p>
                    </div>
                `;
                return;
            }
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø²Ù…Ø§Ù† ÙØ¹Ø§Ù„
            checkActiveTime();
            
            if (isActiveTime) {
                // Ø²Ù…Ø§Ù† ÙØ¹Ø§Ù„ - Ø¯Ø±ÛŒØ§ÙØª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
                try {
                    const data = await fetchGoldPrices();
                    displayPrices(data, false);
                } catch (error) {
                    // Ø§Ú¯Ø± Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø¬Ø¯ÛŒØ¯ØŒ Ø§Ø² Ú©Ø´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
                    if (loadCachedPrices()) {
                        displayPrices(cachedPrices.prices, true);
                    } else {
                        displayError('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ Ø§Ø² API');
                    }
                }
            } else {
                // Ø²Ù…Ø§Ù† ØºÛŒØ±ÙØ¹Ø§Ù„ - Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
                if (loadCachedPrices()) {
                    displayPrices(cachedPrices.prices, true);
                } else {
                    container.innerHTML = `
                        <div class="offline-notice">
                            <i class="fas fa-moon"></i>
                            <p>Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±ÛŒ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯Ù‡ Ø§Ø³Øª</p>
                            <p style="margin-top: 5px; font-size: 0.7rem;">
                                Ù‡ÛŒÚ† Ù‚ÛŒÙ…ØªÛŒ Ø¯Ø± Ø­Ø§ÙØ¸Ù‡ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                            </p>
                            <p style="margin-top: 5px; font-size: 0.7rem;">
                                Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¨Ø¹Ø¯ÛŒ: ÙØ±Ø¯Ø§ Ø³Ø§Ø¹Øª Û±Û±:Û°Û° ØµØ¨Ø­
                            </p>
                        </div>
                    `;
                }
            }
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§
        function displayError(message) {
            const container = document.getElementById('priceContainer');
            container.innerHTML = `
                <div class="error">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>${message}</p>
                    <button onclick="loadPrices()" style="
                        background: #85d0cb;
                        color: #000;
                        border: none;
                        padding: 8px 16px;
                        border-radius: 6px;
                        margin-top: 10px;
                        cursor: pointer;
                        font-family: 'Vazirmatn';
                    ">ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯</button>
                </div>
            `;
        }

        // Ø´Ø±ÙˆØ¹ Ø¨Ø±Ù†Ø§Ù…Ù‡
        document.addEventListener('DOMContentLoaded', function() {
            // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡ API
            initializeApiCounter();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
            loadCachedPrices();
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø²Ù…Ø§Ù†
            checkActiveTime();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± 1 Ø¯Ù‚ÛŒÙ‚Ù‡
            setInterval(() => {
                if (pricePanelVisible) {
                    loadPrices();
                }
            }, 1 * 60 * 1000); // 1 Ø¯Ù‚ÛŒÙ‚Ù‡
            
            // Ø¨Ø±Ø±Ø³ÛŒ ØªØºÛŒÛŒØ± Ø±ÙˆØ² (Ø¨Ø±Ø§ÛŒ Ø±ÛŒØ³Øª Ø´Ù…Ø§Ø±Ù†Ø¯Ù‡)
            setInterval(() => {
                initializeApiCounter();
            }, 60 * 60 * 1000); // Ù‡Ø± 1 Ø³Ø§Ø¹Øª Ú†Ú© Ú©Ù†
            
            // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ¶Ø¹ÛŒØª Ø²Ù…Ø§Ù† Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
            setInterval(() => {
                checkActiveTime();
            }, 30 * 1000);
        });
    </script>
</body>
</html>
